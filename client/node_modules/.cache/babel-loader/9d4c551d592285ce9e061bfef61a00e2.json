{"ast":null,"code":"import _regeneratorRuntime from \"C:\\\\Users\\\\ASUS\\\\Desktop\\\\commons-0.1.0\\\\client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/regenerator\";\nimport _asyncToGenerator from \"C:\\\\Users\\\\ASUS\\\\Desktop\\\\commons-0.1.0\\\\client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/asyncToGenerator\";\nimport _classCallCheck from \"C:\\\\Users\\\\ASUS\\\\Desktop\\\\commons-0.1.0\\\\client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"C:\\\\Users\\\\ASUS\\\\Desktop\\\\commons-0.1.0\\\\client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"C:\\\\Users\\\\ASUS\\\\Desktop\\\\commons-0.1.0\\\\client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"C:\\\\Users\\\\ASUS\\\\Desktop\\\\commons-0.1.0\\\\client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"C:\\\\Users\\\\ASUS\\\\Desktop\\\\commons-0.1.0\\\\client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"C:\\\\Users\\\\ASUS\\\\Desktop\\\\commons-0.1.0\\\\client\\\\src\\\\components\\\\organisms\\\\AssetsUser.tsx\";\nimport React, { PureComponent } from 'react';\nimport { Link } from 'react-router-dom';\nimport { Logger } from '@oceanprotocol/squid';\nimport { User } from '../../context/User';\nimport Spinner from '../atoms/Spinner';\nimport Asset from '../molecules/Asset';\nimport Web3message from './Web3message';\nimport styles from './AssetsUser.module.scss';\n\nvar AssetsUser =\n/*#__PURE__*/\nfunction (_PureComponent) {\n  _inherits(AssetsUser, _PureComponent);\n\n  function AssetsUser() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, AssetsUser);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(AssetsUser)).call.apply(_getPrototypeOf2, [this].concat(args)));\n    _this.state = {\n      results: [],\n      isLoading: true\n    };\n    return _this;\n  }\n\n  _createClass(AssetsUser, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      this.searchOcean();\n    }\n  }, {\n    key: \"searchOcean\",\n    value: function () {\n      var _searchOcean = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee2() {\n        var _this2 = this;\n\n        return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                if (this.context.account) {\n                  this.context.ocean.keeper.didRegistry.contract.getPastEvents('DIDAttributeRegistered', {\n                    filter: {\n                      _owner: this.context.account\n                    },\n                    fromBlock: 0,\n                    toBlock: 'latest'\n                  },\n                  /*#__PURE__*/\n                  function () {\n                    var _ref = _asyncToGenerator(\n                    /*#__PURE__*/\n                    _regeneratorRuntime.mark(function _callee(error, events) {\n                      var results, _iteratorNormalCompletion, _didIteratorError, _iteratorError, _iterator, _step, event, ddo;\n\n                      return _regeneratorRuntime.wrap(function _callee$(_context) {\n                        while (1) {\n                          switch (_context.prev = _context.next) {\n                            case 0:\n                              if (!error) {\n                                _context.next = 5;\n                                break;\n                              }\n\n                              Logger.log('error retrieving', error);\n\n                              _this2.setState({\n                                isLoading: false\n                              });\n\n                              _context.next = 35;\n                              break;\n\n                            case 5:\n                              results = [];\n                              _iteratorNormalCompletion = true;\n                              _didIteratorError = false;\n                              _iteratorError = undefined;\n                              _context.prev = 9;\n                              _iterator = events[Symbol.iterator]();\n\n                            case 11:\n                              if (_iteratorNormalCompletion = (_step = _iterator.next()).done) {\n                                _context.next = 20;\n                                break;\n                              }\n\n                              event = _step.value;\n                              _context.next = 15;\n                              return _this2.context.ocean.assets.resolve(\"did:op:\".concat(event.returnValues._did.substring(2)));\n\n                            case 15:\n                              ddo = _context.sent;\n                              results.push(ddo);\n\n                            case 17:\n                              _iteratorNormalCompletion = true;\n                              _context.next = 11;\n                              break;\n\n                            case 20:\n                              _context.next = 26;\n                              break;\n\n                            case 22:\n                              _context.prev = 22;\n                              _context.t0 = _context[\"catch\"](9);\n                              _didIteratorError = true;\n                              _iteratorError = _context.t0;\n\n                            case 26:\n                              _context.prev = 26;\n                              _context.prev = 27;\n\n                              if (!_iteratorNormalCompletion && _iterator.return != null) {\n                                _iterator.return();\n                              }\n\n                            case 29:\n                              _context.prev = 29;\n\n                              if (!_didIteratorError) {\n                                _context.next = 32;\n                                break;\n                              }\n\n                              throw _iteratorError;\n\n                            case 32:\n                              return _context.finish(29);\n\n                            case 33:\n                              return _context.finish(26);\n\n                            case 34:\n                              _this2.setState({\n                                results: results,\n                                isLoading: false\n                              });\n\n                            case 35:\n                            case \"end\":\n                              return _context.stop();\n                          }\n                        }\n                      }, _callee, null, [[9, 22, 26, 34], [27,, 29, 33]]);\n                    }));\n\n                    return function (_x, _x2) {\n                      return _ref.apply(this, arguments);\n                    };\n                  }());\n                } else {\n                  this.setState({\n                    isLoading: false\n                  });\n                }\n\n              case 1:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2, this);\n      }));\n\n      function searchOcean() {\n        return _searchOcean.apply(this, arguments);\n      }\n\n      return searchOcean;\n    }()\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this3 = this;\n\n      return this.context.isNile && this.context.account ? React.createElement(\"div\", {\n        className: styles.assetsUser,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 52\n        },\n        __self: this\n      }, this.props.recent && React.createElement(\"h2\", {\n        className: styles.subTitle,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 54\n        },\n        __self: this\n      }, \"Your Latest Published Data Sets\"), this.state.isLoading ? React.createElement(Spinner, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 60\n        },\n        __self: this\n      }) : this.state.results.length ? React.createElement(React.Fragment, null, this.state.results.slice(0, this.props.recent ? this.props.recent : undefined).filter(function (asset) {\n        return !!asset;\n      }).map(function (asset) {\n        return React.createElement(Asset, {\n          list: _this3.props.list,\n          key: asset.id,\n          asset: asset,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 72\n          },\n          __self: this\n        });\n      }), this.props.recent && React.createElement(Link, {\n        className: styles.link,\n        to: '/history',\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 79\n        },\n        __self: this\n      }, \"All Data Sets\")) : React.createElement(\"div\", {\n        className: styles.empty,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 85\n        },\n        __self: this\n      }, React.createElement(\"p\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 86\n        },\n        __self: this\n      }, \"No Data Sets Yet.\"), React.createElement(Link, {\n        to: \"/publish\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 87\n        },\n        __self: this\n      }, \"+ Publish A Data Set\"))) : React.createElement(Web3message, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 92\n        },\n        __self: this\n      });\n    }\n  }]);\n\n  return AssetsUser;\n}(PureComponent);\n\nexport { AssetsUser as default };\nAssetsUser.contextType = User;","map":{"version":3,"sources":["C:\\Users\\ASUS\\Desktop\\commons-0.1.0\\client\\src\\components\\organisms\\AssetsUser.tsx"],"names":["React","PureComponent","Link","Logger","User","Spinner","Asset","Web3message","styles","AssetsUser","state","results","isLoading","searchOcean","context","account","ocean","keeper","didRegistry","contract","getPastEvents","filter","_owner","fromBlock","toBlock","error","events","log","setState","event","assets","resolve","returnValues","_did","substring","ddo","push","isNile","assetsUser","props","recent","subTitle","length","slice","undefined","asset","map","list","id","link","empty","contextType"],"mappings":"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","sourcesContent":["import React, { PureComponent } from 'react'\nimport { Link } from 'react-router-dom'\nimport { Logger } from '@oceanprotocol/squid'\nimport { User } from '../../context/User'\nimport Spinner from '../atoms/Spinner'\nimport Asset from '../molecules/Asset'\nimport Web3message from './Web3message'\nimport styles from './AssetsUser.module.scss'\n\nexport default class AssetsUser extends PureComponent<\n    { list?: boolean; recent?: number },\n    { results: any[]; isLoading: boolean }\n> {\n    public state = { results: [], isLoading: true }\n\n    public componentDidMount() {\n        this.searchOcean()\n    }\n\n    private async searchOcean() {\n        if (this.context.account) {\n            this.context.ocean.keeper.didRegistry.contract.getPastEvents(\n                'DIDAttributeRegistered',\n                {\n                    filter: { _owner: this.context.account },\n                    fromBlock: 0,\n                    toBlock: 'latest'\n                },\n                async (error: any, events: any) => {\n                    if (error) {\n                        Logger.log('error retrieving', error)\n                        this.setState({ isLoading: false })\n                    } else {\n                        const results = []\n                        for (const event of events) {\n                            const ddo = await this.context.ocean.assets.resolve(\n                                `did:op:${event.returnValues._did.substring(2)}`\n                            )\n                            results.push(ddo)\n                        }\n                        this.setState({ results, isLoading: false })\n                    }\n                }\n            )\n        } else {\n            this.setState({ isLoading: false })\n        }\n    }\n\n    public render() {\n        return this.context.isNile && this.context.account ? (\n            <div className={styles.assetsUser}>\n                {this.props.recent && (\n                    <h2 className={styles.subTitle}>\n                        Your Latest Published Data Sets\n                    </h2>\n                )}\n\n                {this.state.isLoading ? (\n                    <Spinner />\n                ) : this.state.results.length ? (\n                    <>\n                        {this.state.results\n                            .slice(\n                                0,\n                                this.props.recent\n                                    ? this.props.recent\n                                    : undefined\n                            )\n                            .filter(asset => !!asset)\n                            .map((asset: any) => (\n                                <Asset\n                                    list={this.props.list}\n                                    key={asset.id}\n                                    asset={asset}\n                                />\n                            ))}\n                        {this.props.recent && (\n                            <Link className={styles.link} to={'/history'}>\n                                All Data Sets\n                            </Link>\n                        )}\n                    </>\n                ) : (\n                    <div className={styles.empty}>\n                        <p>No Data Sets Yet.</p>\n                        <Link to=\"/publish\">+ Publish A Data Set</Link>\n                    </div>\n                )}\n            </div>\n        ) : (\n            <Web3message />\n        )\n    }\n}\n\nAssetsUser.contextType = User\n"]},"metadata":{},"sourceType":"module"}